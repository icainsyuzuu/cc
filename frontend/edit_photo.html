<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Ganti Foto Profil - EcoWaste</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/css/style.css" />
</head>

<body>
    <div id="navbar-container"></div>

    <div class="container">
        <h1>üì∏ Ganti Foto Profil</h1>
        <form id="photoForm">
            <input type="file" id="photo" accept="image/*" required /><br><br>
            <button type="submit" class="mockup-button">Upload</button>
        </form>
        <br><a href="profile.html">‚Üê Kembali ke Profil</a>
    </div>

    <script type="module" src="config.js"></script>
    <script type="module">
        import { BASE_URL } from "./config.js";
        const token = sessionStorage.getItem("accessToken");

        document.getElementById("photoForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const file = document.getElementById("photo").files[0];
            const formData = new FormData();
            formData.append("photo", file);

            try {
                const res = await fetch(`${BASE_URL}/user/profile/photo`, {
                    method: "PUT",
                    headers: { Authorization: "Bearer " + token },
                    body: formData
                });

                if (!res.ok) throw new Error("Upload gagal");
                alert("Foto profil berhasil diubah");
                window.location.href = "profile.html";
            } catch (err) {
                alert("Error: " + err.message);
            }
        });
    </script>
    <script src="assets/js/loadNavbar.js"></script>
</body>

</html>